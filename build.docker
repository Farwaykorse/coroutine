#
#   Until GCC Coroutine becomes stable, this file will allow build failure
#
FROM luncliff/gcc as builder

ENV CC=gcc-10 CXX=gcc-10

RUN apt install -y -qq --fix-missing --no-install-recommends \
    curl rsync wget tar
RUN curl -s https://raw.githubusercontent.com/luncliff/coroutine/master/scripts/install-cmake-3.14.sh | bash

WORKDIR /code
COPY . .

WORKDIR /code/build
RUN cmake .. -DBUILD_SHARED_LIBS=true -DCMAKE_BUILD_TYPE=Debug
RUN make || true
